<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Baseline Model | Todd’s Data Science Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Baseline Model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A blog to track my data science learning and help others on their journey" />
<meta property="og:description" content="A blog to track my data science learning and help others on their journey" />
<link rel="canonical" href="https://toodoi.github.io/datascience/2021/01/07/JobSalaryPrediction.html" />
<meta property="og:url" content="https://toodoi.github.io/datascience/2021/01/07/JobSalaryPrediction.html" />
<meta property="og:site_name" content="Todd’s Data Science Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-07T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://toodoi.github.io/datascience/2021/01/07/JobSalaryPrediction.html","@type":"BlogPosting","headline":"Baseline Model","dateModified":"2021-01-07T00:00:00-06:00","datePublished":"2021-01-07T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://toodoi.github.io/datascience/2021/01/07/JobSalaryPrediction.html"},"description":"A blog to track my data science learning and help others on their journey","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/datascience/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://toodoi.github.io/datascience/feed.xml" title="Todd's Data Science Blog" /><link rel="shortcut icon" type="image/x-icon" href="/datascience/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/datascience/">Todd&#39;s Data Science Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/datascience/about/">About Me</a><a class="page-link" href="/datascience/search/">Search</a><a class="page-link" href="/datascience/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Baseline Model</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-01-07T00:00:00-06:00" itemprop="datePublished">
        Jan 7, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      13 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Toodoi/datascience/tree/master/_notebooks/2021-01-07-JobSalaryPrediction.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/datascience/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Toodoi/datascience/master?filepath=_notebooks%2F2021-01-07-JobSalaryPrediction.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/datascience/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Toodoi/datascience/blob/master/_notebooks/2021-01-07-JobSalaryPrediction.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/datascience/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-01-07-JobSalaryPrediction.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Job-Salary-Prediction">Job Salary Prediction<a class="anchor-link" href="#Job-Salary-Prediction"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a quick notebook detailing a model I built for a Kaggle competition from 2013 where Adzuna asked entrants to predict job salaries based on a dataset they supplied. This is the first model I have built which relies solely on text data which provided a good experience for working on messy data that required a lot of feature engineering.</p>
<p>The first few rows of the DataFrame are displayed below with summary statistics. SalaryNormalized is the variable to be predicted.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">fastai.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&#34;/content/drive&#34;, force_remount=True).
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/Train_reesby.csv&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SalaryRaw&#39;</span><span class="p">,</span> <span class="s1">&#39;LocationRaw&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>Title</th>
      <th>FullDescription</th>
      <th>LocationNormalized</th>
      <th>ContractType</th>
      <th>ContractTime</th>
      <th>Company</th>
      <th>Category</th>
      <th>SalaryNormalized</th>
      <th>SourceName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12612628</td>
      <td>Engineering Systems Analyst</td>
      <td>Engineering Systems Analyst Dorking Surrey Salary ****K Our client is located in Dorking, Surrey and are looking for Engineering Systems Analyst our client provides specialist software development Keywords Mathematical Modelling, Risk Analysis, System Modelling, Optimisation, MISER, PIONEEER Engineering Systems Analyst Dorking Surrey Salary ****K</td>
      <td>Dorking</td>
      <td>NaN</td>
      <td>permanent</td>
      <td>Gregory Martin International</td>
      <td>Engineering Jobs</td>
      <td>25000</td>
      <td>cv-library.co.uk</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12612830</td>
      <td>Stress Engineer Glasgow</td>
      <td>Stress Engineer Glasgow Salary **** to **** We re currently looking for talented engineers to join our growing Glasgow team at a variety of levels. The roles are ideally suited to high calibre engineering graduates with any level of appropriate experience, so that we can give you the opportunity to use your technical skills to provide high quality input to our aerospace projects, spanning both aerostructures and aeroengines. In return, you can expect good career opportunities and the chance for advancement and personal and professional development, support while you gain Chartership and so...</td>
      <td>Glasgow</td>
      <td>NaN</td>
      <td>permanent</td>
      <td>Gregory Martin International</td>
      <td>Engineering Jobs</td>
      <td>30000</td>
      <td>cv-library.co.uk</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12612844</td>
      <td>Modelling and simulation analyst</td>
      <td>Mathematical Modeller / Simulation Analyst / Operational Analyst Basingstoke, Hampshire Up to ****K AAE pension contribution, private medical and dental The opportunity Our client is an independent consultancy firm which has an opportunity for a Data Analyst with 35 years experience. The role will require the successful candidate to demonstrate their ability to analyse a problem and arrive at a solution, with varying levels of data being available. Essential skills Thorough knowledge of Excel and proven ability to utilise this to create powerful decision support models Experience in Modell...</td>
      <td>Hampshire</td>
      <td>NaN</td>
      <td>permanent</td>
      <td>Gregory Martin International</td>
      <td>Engineering Jobs</td>
      <td>30000</td>
      <td>cv-library.co.uk</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12613049</td>
      <td>Engineering Systems Analyst / Mathematical Modeller</td>
      <td>Engineering Systems Analyst / Mathematical Modeller. Our client is a highly successful and respected Consultancy providing specialist software development MISER, PIONEER, Maths, Mathematical, Optimisation, Risk Analysis, Asset Management, Water Industry, Access, Excel, VBA, SQL, Systems . Engineering Systems Analyst / Mathematical Modeller. Salary  ****K****K negotiable Location Dorking, Surrey</td>
      <td>Surrey</td>
      <td>NaN</td>
      <td>permanent</td>
      <td>Gregory Martin International</td>
      <td>Engineering Jobs</td>
      <td>27500</td>
      <td>cv-library.co.uk</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12613647</td>
      <td>Pioneer, Miser Engineering Systems Analyst</td>
      <td>Pioneer, Miser  Engineering Systems Analyst Dorking  Surrey Salary ****K Located in Surrey, our client provides specialist software development Pioneer, Miser  Engineering Systems Analyst Dorking  Surrey Salary ****K</td>
      <td>Surrey</td>
      <td>NaN</td>
      <td>permanent</td>
      <td>Gregory Martin International</td>
      <td>Engineering Jobs</td>
      <td>25000</td>
      <td>cv-library.co.uk</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 244768 entries, 0 to 244767
Data columns (total 10 columns):
 #   Column              Non-Null Count   Dtype 
---  ------              --------------   ----- 
 0   Id                  244768 non-null  int64 
 1   Title               244767 non-null  object
 2   FullDescription     244768 non-null  object
 3   LocationNormalized  244768 non-null  object
 4   ContractType        65442 non-null   object
 5   ContractTime        180863 non-null  object
 6   Company             212338 non-null  object
 7   Category            244768 non-null  object
 8   SalaryNormalized    244768 non-null  int64 
 9   SourceName          244767 non-null  object
dtypes: int64(2), object(8)
memory usage: 18.7+ MB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fill the one missing Title field using info from FullDescription</span>
<span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1588</span><span class="p">,</span> <span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Quality Improvement Manager&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalaryNormalized&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalaryNormalized&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalaryNormalized&#39;</span><span class="p">],</span> <span class="n">baseline</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>13399.57843160822</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next I test what kind of accuracy can be achieved simply by feeding a model the raw data.</p>
<p>I use a RandomForest because they consistently perform well on most datasets. Later on I will use a Neural Network as well.</p>
<p>I'm using some features of the fast.ai library to encode categorical variables and easily arrange the data to feed into the models.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">splitter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span> <span class="c1">## Train/test splitting function</span>
  <span class="n">rand_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randperm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
  <span class="n">cut</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">rand_idx</span><span class="p">[</span><span class="n">cut</span><span class="p">:],</span><span class="n">rand_idx</span><span class="p">[:</span><span class="n">cut</span><span class="p">]</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">]</span> <span class="c1"># Encodes the categorical features</span>
<span class="n">dep_var</span> <span class="o">=</span> <span class="s1">&#39;SalaryNormalized&#39;</span> <span class="c1"># Specify dependent variable</span>
<span class="n">cat_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="s1">&#39;FullDescription&#39;</span><span class="p">,</span> <span class="s1">&#39;LocationNormalized&#39;</span><span class="p">,</span> <span class="s1">&#39;ContractType&#39;</span><span class="p">,</span> <span class="s1">&#39;ContractTime&#39;</span><span class="p">,</span> <span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;SourceName&#39;</span><span class="p">]</span>
<span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_vars</span><span class="p">,</span> <span class="n">y_names</span> <span class="o">=</span> <span class="n">dep_var</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>

<span class="n">xs</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">y</span>
<span class="n">valid_xs</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">forest</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">175_000</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="n">min_samples_leaf</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">naive_model</span> <span class="o">=</span> <span class="n">forest</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">naive_model_preds</span> <span class="o">=</span> <span class="n">naive_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nm_train_score</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">naive_model_preds</span><span class="p">)</span>
<span class="n">nm_valid_score</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">naive_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Naive Model scored a MAE of </span><span class="si">{}</span><span class="s1"> on the training data and </span><span class="si">{}</span><span class="s1"> on the validation data.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nm_train_score</span><span class="p">,</span> <span class="n">nm_valid_score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The Naive Model scored a MAE of 6249.058199242024 on the training data and 8584.078321490439 on the validation data.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-RandomForest-performed-much-better-than-the-baseline-model-and-has-less-than-half-the-error-rate-when-evaluated-on-the-test-set.">The RandomForest performed much better than the baseline model and has less than half the error rate when evaluated on the test set.<a class="anchor-link" href="#The-RandomForest-performed-much-better-than-the-baseline-model-and-has-less-than-half-the-error-rate-when-evaluated-on-the-test-set."> </a></h3><h3 id="The-cardinality-of-the-Title-feature-is-very-high-(135,436-unique-values,-which-is-about-55%-of-the-dataset).-This-is-because-one-job-title,-such-as-Systems-Engineer,-is-represented-in-the-dataset-in-many-additional-ways-that-don't-carry-much-extra-meaning-or-can-be-represented-using-other-features-(e.g.-'Systems-Engineer-London'-or-'Engineering,-Systems').">The cardinality of the <code>Title</code> feature is very high (135,436 unique values, which is about 55% of the dataset). This is because one job title, such as Systems Engineer, is represented in the dataset in many additional ways that don't carry much extra meaning or can be represented using other features (e.g. 'Systems Engineer London' or 'Engineering, Systems').<a class="anchor-link" href="#The-cardinality-of-the-Title-feature-is-very-high-(135,436-unique-values,-which-is-about-55%-of-the-dataset).-This-is-because-one-job-title,-such-as-Systems-Engineer,-is-represented-in-the-dataset-in-many-additional-ways-that-don't-carry-much-extra-meaning-or-can-be-represented-using-other-features-(e.g.-'Systems-Engineer-London'-or-'Engineering,-Systems')."> </a></h3><h3 id="To-resolve-this-I-will-scrape-the-most-common-words-from-the-job-titles-and-assign-them-to-each-record.-This-should-improve-the-model's-accuracy-by-having-considerably-more-records-belonging-to-fewer,-but-much-more-predictively-important-titles-such-as-Engineer,-Teacher,-Chef.">To resolve this I will scrape the most common words from the job titles and assign them to each record. This should improve the model's accuracy by having considerably more records belonging to fewer, but much more predictively important titles such as Engineer, Teacher, Chef.<a class="anchor-link" href="#To-resolve-this-I-will-scrape-the-most-common-words-from-the-job-titles-and-assign-them-to-each-record.-This-should-improve-the-model's-accuracy-by-having-considerably-more-records-belonging-to-fewer,-but-much-more-predictively-important-titles-such-as-Engineer,-Teacher,-Chef."> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>135436</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Counts the 500 most common words in the Title feature</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">job_word_dict</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">())</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
<span class="n">job_word_dict</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This cell cleans up the job_word_dict by removing non-alphanumeric entries and some &#39;joining&#39; words</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">job_word_dict</span><span class="p">:</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
    <span class="n">job_word_dict</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">trash_words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="s1">&#39;for&#39;</span><span class="p">,</span> <span class="s1">&#39;with&#39;</span><span class="p">]</span> <span class="c1"># I decided to remove these &#39;joining&#39; words and keep more informative words such as Engineer or Teacher</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">trash_words</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">job_word_dict</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
      <span class="n">job_word_dict</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The 15 most common words in the job titles are shown below. 'London' has made the list which means locations are fairly prevalent in the job title. However since I already have a location feature, I will remove them from this list.</p>
<p>You can also see that positions of seniority (e.g. Manager, Senior, Executive) are also very common. After experimenting with a few different combinations of features on different models, I found that splitting position seniority out into it's own feature improved the accuracy. This makes sense intuitively that having one feature to describe the role (Electrical Engineer, Software Developer) and another feature to adjust each roles seniority level would yield better results.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">job_word_dict</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;Manager&#39;, 45109),
 (&#39;Engineer&#39;, 22161),
 (&#39;Sales&#39;, 17096),
 (&#39;Senior&#39;, 15925),
 (&#39;Developer&#39;, 11914),
 (&#39;Assistant&#39;, 10995),
 (&#39;Business&#39;, 9296),
 (&#39;Executive&#39;, 8954),
 (&#39;Analyst&#39;, 8387),
 (&#39;Consultant&#39;, 8153),
 (&#39;London&#39;, 8073),
 (&#39;Support&#39;, 7729),
 (&#39;Project&#39;, 6814),
 (&#39;Nurse&#39;, 6440),
 (&#39;Development&#39;, 6396)]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This cell removes position seniority level words from the job_word_dict</span>
<span class="n">seniority_level</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Manager&#39;</span><span class="p">,</span> <span class="s1">&#39;Senior&#39;</span><span class="p">,</span> <span class="s1">&#39;Assistant&#39;</span><span class="p">,</span> <span class="s1">&#39;Executive&#39;</span><span class="p">,</span> <span class="s1">&#39;Advisor&#39;</span><span class="p">,</span> <span class="s1">&#39;Worker&#39;</span><span class="p">,</span> <span class="s1">&#39;Head&#39;</span><span class="p">,</span> <span class="s1">&#39;Graduate&#39;</span><span class="p">,</span> <span class="s1">&#39;Lead&#39;</span><span class="p">,</span> <span class="s1">&#39;Coordinator&#39;</span><span class="p">,</span> <span class="s1">&#39;Director&#39;</span><span class="p">,</span> <span class="s1">&#39;Leader&#39;</span><span class="p">,</span> <span class="s1">&#39;Supervisor&#39;</span><span class="p">,</span> <span class="s1">&#39;Junior&#39;</span><span class="p">,</span> <span class="s1">&#39;Trainee&#39;</span><span class="p">,</span> <span class="s1">&#39;Deputy&#39;</span><span class="p">]</span>

<span class="n">job_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">job_word_dict</span><span class="p">:</span>
  <span class="n">job_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">job_words</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">seniority_level</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">position</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
      <span class="n">job_words</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Removed </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">location_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LocationNormalized&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">job_words</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">location_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">location</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
      <span class="n">job_words</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Removed </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">findWholeWord</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b(</span><span class="si">{0}</span><span class="s1">)\b&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span><span class="o">.</span><span class="n">search</span>

<span class="k">def</span> <span class="nf">map_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">seniority_level</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">key</span><span class="p">)(</span><span class="n">x</span><span class="p">):</span>
          <span class="n">match</span> <span class="o">=</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">key</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">continue</span>
    <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;seniority&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Title</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_function</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ten-most-common-seniority-positions-in-the-data">Ten most common seniority positions in the data<a class="anchor-link" href="#Ten-most-common-seniority-positions-in-the-data"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;seniority&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>                     134846
manager               40354
senior                12374
assistant              8360
executive              8156
advisor                4088
worker                 3493
head                   3420
coordinator            2790
manager assistant      2619
Name: seniority, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">map_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">job_words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">):</span>
          <span class="n">match</span> <span class="o">=</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">continue</span>
    <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;job_words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Title</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_function</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="15-most-common-job-word-combinations-in-the-data">15 most common job word combinations in the data<a class="anchor-link" href="#15-most-common-job-word-combinations-in-the-data"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;job_words&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>                          13022
sales                      3065
engineer                   2018
project                    1818
business development       1808
account                    1448
marketing                  1251
consultant recruitment     1192
administrator              1054
developer                  1027
finance                    1019
teacher                     942
accountant management       919
care                        871
surveyor quantity           856
Name: job_words, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-the-data-and-load-it-into-the-RandomForest-model">Prepare the data and load it into the RandomForest model<a class="anchor-link" href="#Prepare-the-data-and-load-it-into-the-RandomForest-model"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">]</span>
<span class="n">dep_var</span> <span class="o">=</span> <span class="s1">&#39;SalaryNormalized&#39;</span>
<span class="n">cat_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LocationNormalized&#39;</span><span class="p">,</span> <span class="s1">&#39;ContractType&#39;</span><span class="p">,</span> <span class="s1">&#39;ContractTime&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;SourceName&#39;</span><span class="p">,</span> <span class="s1">&#39;seniority&#39;</span><span class="p">,</span> <span class="s1">&#39;job_words&#39;</span><span class="p">]</span>
<span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_vars</span><span class="p">,</span> <span class="n">y_names</span> <span class="o">=</span> <span class="n">dep_var</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">y</span>
<span class="n">valid_xs</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">y</span>

<span class="n">rf_model</span> <span class="o">=</span> <span class="n">forest</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">forest_preds</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">rf_train_score</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">forest_preds</span><span class="p">)</span>
<span class="n">valid_preds</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs</span><span class="p">)</span>
<span class="n">rf_valid_score</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">valid_preds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Feature Engineered Model scored a MAE of </span><span class="si">{}</span><span class="s1"> on the training data and </span><span class="si">{}</span><span class="s1"> on the validation data.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rf_train_score</span><span class="p">,</span> <span class="n">rf_valid_score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The Feature Engineered Model scored a MAE of 5736.43454654603 on the training data and 7574.226276235397 on the validation data.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model has a MAE of 7574.2 on the validation set compared to a MAE of 8,584.1 that we received from feeding the model the raw data. So the feature engineering has produced an improvement to the models prediction accuracy.</p>
<p>Below I plot the average accuracy of the 40 estimators (trees) that make up the random forest. Starting with one estimator and moving to the average of all 40 we can see how combinations of estimators with different uncorrelated errors in aggregate produce a better accuracy.</p>
<p>The graph also shows the diminishing return of adding extra estimators and that moving past 40 will not have much further impact for accuracy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">estimators_</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">preds</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">valid_y</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">)]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The table below shows which features have the most impact on the model's accuracy. We can see that the 2 engineered features have the most importance.</p>
<p><code>ContractType</code> is at the bottom and not an important feature to the model. This feature is binary and tells us whether a job is full or part time. However it has a huge amount of missing values which is probably why it does not yield much predictive power and can probably be removed without much loss to accuracy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rf_feat_importance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cols&#39;</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;imp&#39;</span><span class="p">:</span><span class="n">m</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">}</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;imp&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fi</span> <span class="o">=</span> <span class="n">rf_feat_importance</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">fi</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cols</th>
      <th>imp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>job_words</td>
      <td>0.256270</td>
    </tr>
    <tr>
      <th>6</th>
      <td>seniority</td>
      <td>0.199424</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Category</td>
      <td>0.156270</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SourceName</td>
      <td>0.133602</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Company</td>
      <td>0.096062</td>
    </tr>
    <tr>
      <th>0</th>
      <td>LocationNormalized</td>
      <td>0.081501</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ContractTime</td>
      <td>0.065240</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ContractType</td>
      <td>0.011631</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Run-the-model-again-without-the-ContractType-feature-since-it-has-very-low-feature-importance.">Run the model again without the ContractType feature since it has very low feature importance.<a class="anchor-link" href="#Run-the-model-again-without-the-ContractType-feature-since-it-has-very-low-feature-importance."> </a></h3><h3 id="The-accuracy-of-the-model-actually-slightly-improves-on-the-validation-set-after-removing-this-feature">The accuracy of the model actually slightly improves on the validation set after removing this feature<a class="anchor-link" href="#The-accuracy-of-the-model-actually-slightly-improves-on-the-validation-set-after-removing-this-feature"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LocationNormalized&#39;</span><span class="p">,</span> <span class="s1">&#39;ContractTime&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;SourceName&#39;</span><span class="p">,</span> <span class="s1">&#39;seniority&#39;</span><span class="p">,</span> <span class="s1">&#39;job_words&#39;</span><span class="p">]</span> <span class="c1"># Removed ContractType</span>
<span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">procs</span><span class="p">,</span> <span class="n">cat_vars</span><span class="p">,</span> <span class="n">y_names</span> <span class="o">=</span> <span class="n">dep_var</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">y</span>
<span class="n">valid_xs</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">y</span>

<span class="n">rf_model</span> <span class="o">=</span> <span class="n">forest</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

<span class="n">forest_preds</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">rf_train_score</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">forest_preds</span><span class="p">)</span>
<span class="n">valid_preds</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_xs</span><span class="p">)</span>
<span class="n">rf_valid_score</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">valid_preds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Feature Engineered Model scored a MAE of </span><span class="si">{}</span><span class="s1"> on the training data and </span><span class="si">{}</span><span class="s1"> on the validation data.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rf_train_score</span><span class="p">,</span> <span class="n">rf_valid_score</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The Feature Engineered Model scored a MAE of 5755.869472062523 on the training data and 7582.1264663855745 on the validation data.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fi</span> <span class="o">=</span> <span class="n">rf_feat_importance</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">fi</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cols</th>
      <th>imp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>job_words</td>
      <td>0.258271</td>
    </tr>
    <tr>
      <th>5</th>
      <td>seniority</td>
      <td>0.197063</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Category</td>
      <td>0.155387</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SourceName</td>
      <td>0.142651</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Company</td>
      <td>0.098565</td>
    </tr>
    <tr>
      <th>0</th>
      <td>LocationNormalized</td>
      <td>0.082658</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ContractTime</td>
      <td>0.065404</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This cell creates a job words feature in the DataFrame. This feature contains any words from the 500 most common Title words associated with a record</span>
<span class="k">def</span> <span class="nf">map_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">job_words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">):</span>
          <span class="n">match</span> <span class="o">=</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>


<span class="n">df</span><span class="p">[</span><span class="s1">&#39;jword_primary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Title</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_function</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This cell creates a job words feature in the DataFrame. This feature contains any words from the 500 most common Title words associated with a record</span>
<span class="k">def</span> <span class="nf">map_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">job_words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]):</span>
          <span class="n">match</span> <span class="o">=</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">])</span>
          <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;jword_primrary&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>


<span class="n">df</span><span class="p">[</span><span class="s1">&#39;jword_secondary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="s1">&#39;jword_primrary&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This cell creates a job words feature in the DataFrame. This feature contains any words from the 500 most common Title words associated with a record</span>
<span class="k">def</span> <span class="nf">map_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">job_words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]):</span>
          <span class="n">match</span> <span class="o">=</span> <span class="n">findWholeWord</span><span class="p">(</span><span class="n">word</span><span class="p">)(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">])</span>
          <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;jword_primrary&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;jword_secondary&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>


<span class="n">df</span><span class="p">[</span><span class="s1">&#39;jword_tertiary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="s1">&#39;jword_primrary&#39;</span><span class="p">,</span> <span class="s1">&#39;jword_secondary&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Network">Neural Network<a class="anchor-link" href="#Neural-Network"> </a></h1><h3 id="Along-with-RandomForest,-Neural-Networks-consistently-achieve-good-results-on-most-datasets.">Along with RandomForest, Neural Networks consistently achieve good results on most datasets.<a class="anchor-link" href="#Along-with-RandomForest,-Neural-Networks-consistently-achieve-good-results-on-most-datasets."> </a></h3><h3 id="Using-the-fast.ai-library-I-can-use-the-work-I-have-already-done-cleaning-and-transforming-the-data-and-quickly-train-a-neural-net.">Using the fast.ai library I can use the work I have already done cleaning and transforming the data and quickly train a neural net.<a class="anchor-link" href="#Using-the-fast.ai-library-I-can-use-the-work-I-have-already-done-cleaning-and-transforming-the-data-and-quickly-train-a-neural-net."> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalaryNormalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalaryNormalized&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">y</span>
<span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(5000, 200000)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">4900</span><span class="p">,</span><span class="mi">210000</span><span class="p">),</span> <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">250</span><span class="p">],</span>
                        <span class="n">n_out</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">mae</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.33113112449646, lr_steep=0.0008317637839354575)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-neural-net-scores-considerably-better-than-the-RandomForest-with-a-MAE-of-6,230-compared-to-7,625-from-the-best-forest-model">The neural net scores considerably better than the RandomForest with a MAE of 6,230 compared to 7,625 from the best forest model<a class="anchor-link" href="#The-neural-net-scores-considerably-better-than-the-RandomForest-with-a-MAE-of-6,230-compared-to-7,625-from-the-best-forest-model"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">7e-4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>12463.211914</td>
      <td>8360.904297</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>1</td>
      <td>7432.699707</td>
      <td>7629.067383</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6397.468750</td>
      <td>7158.133301</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>3</td>
      <td>5603.918457</td>
      <td>6947.498047</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>4</td>
      <td>4933.529297</td>
      <td>6681.348145</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>5</td>
      <td>4315.979492</td>
      <td>6506.173340</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>6</td>
      <td>3694.033691</td>
      <td>6318.576172</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>7</td>
      <td>3117.943604</td>
      <td>6236.548340</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>8</td>
      <td>2581.269043</td>
      <td>6193.021973</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>9</td>
      <td>2283.618896</td>
      <td>6186.819824</td>
      <td>00:06</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Ensembling">Ensembling<a class="anchor-link" href="#Ensembling"> </a></h1><p>Lastly I check to see if ensembling the two models will produce better results. By calculating predictions using both models and taking an average, we hope the errors in one model are uncorrelated with the errors in the other and we gain an improvement in the overall performance.</p>
<p>However the ensemble MAE ends up being 6,451.8 compared to the neural net's MAE of 6,186.8. I think the neural network is just too much better than the forest in this case.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nn_preds</span><span class="p">,</span> <span class="n">targs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">()</span>
<span class="n">ensemble_preds</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_np</span><span class="p">(</span><span class="n">nn_preds</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span> <span class="o">+</span> <span class="n">valid_preds</span><span class="p">)</span> <span class="o">/</span><span class="mi">2</span>
<span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">ensemble_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6451.840949855289</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion"> </a></h1><p>So on average the best model predicts salaries with an error of $6,186.8 which is a great improvement over the baseline model and has improved by over 2,000 compared to the first model I built.</p>
<p>Considering a lot of jobs will advertise salaries within a band of sometimes $10,000 or greater and that the same job is often advertised at different rates, I think this level of error is pretty good for the task.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="There-is-potentially-room-to-improve-the-model-further-by:">There is potentially room to improve the model further by:<a class="anchor-link" href="#There-is-potentially-room-to-improve-the-model-further-by:"> </a></h3><ul>
<li>Improving the <code>seniority</code> and <code>job_words</code> features</li>
<li>Looking to mine some useful data from the FullDescription feature</li>
<li>Looking at ways to fill missing values in <code>ContractType</code> and <code>ContractTime</code></li>
<li>Cleaning up the <code>LocationNormalized</code> feature a bit</li>
<li>Testing on more models and potentially ensembling more</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">count_2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">count_3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">count_4</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;job_words&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
  <span class="n">temp</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">count_1</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">continue</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">count_2</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">continue</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">count_3</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">continue</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
    <span class="n">count_4</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">continue</span>

  
<span class="n">count_1</span><span class="p">,</span> <span class="n">count_2</span><span class="p">,</span> <span class="n">count_3</span><span class="p">,</span> <span class="n">count_4</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(391, 9166, 16345, 11869)</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/datascience/2021/01/07/JobSalaryPrediction.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/datascience/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/datascience/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/datascience/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A blog to track my data science learning and help others on their journey</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Toodoi" title="Toodoi"><svg class="svg-icon grey"><use xlink:href="/datascience/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
