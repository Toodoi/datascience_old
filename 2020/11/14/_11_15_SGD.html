<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Stochastic Gradient Descent | Todd’s Data Science Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Stochastic Gradient Descent" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A blog to track my data science learning and help others on their journey" />
<meta property="og:description" content="A blog to track my data science learning and help others on their journey" />
<link rel="canonical" href="https://toodoi.github.io/datascience/2020/11/14/_11_15_SGD.html" />
<meta property="og:url" content="https://toodoi.github.io/datascience/2020/11/14/_11_15_SGD.html" />
<meta property="og:site_name" content="Todd’s Data Science Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-14T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"A blog to track my data science learning and help others on their journey","url":"https://toodoi.github.io/datascience/2020/11/14/_11_15_SGD.html","@type":"BlogPosting","headline":"Stochastic Gradient Descent","dateModified":"2020-11-14T00:00:00-06:00","datePublished":"2020-11-14T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://toodoi.github.io/datascience/2020/11/14/_11_15_SGD.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/datascience/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://toodoi.github.io/datascience/feed.xml" title="Todd's Data Science Blog" /><link rel="shortcut icon" type="image/x-icon" href="/datascience/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/datascience/">Todd&#39;s Data Science Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/datascience/about/">About Me</a><a class="page-link" href="/datascience/search/">Search</a><a class="page-link" href="/datascience/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Stochastic Gradient Descent</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-14T00:00:00-06:00" itemprop="datePublished">
        Nov 14, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Toodoi/datascience/tree/master/_notebooks/2020_11_15_SGD.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/datascience/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Toodoi/datascience/master?filepath=_notebooks%2F2020_11_15_SGD.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/datascience/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Toodoi/datascience/blob/master/_notebooks/2020_11_15_SGD.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/datascience/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020_11_15_SGD.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install fastai --upgrade
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Stochastic Gradient Descent (SGD) is an optimisation algorithm which can be used to minimise a loss function in order to fit a model.
This notebook illustrates the process of SGD by using it to train an image classifier from scratch. This example is taken from the <a href="https://course.fast.ai/">fast.ai course</a>.</p>
<p>The MNIST dataset is used which contains images of handwritten numbers from 0 to 9. The problem is to create a model that can correctly predict which digit a given image is. For this example the dataset is restricted to the digits <strong>3</strong> and <strong>7</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Downloading-and-preparing-the-dataset">Downloading and preparing the dataset<a class="anchor-link" href="#Downloading-and-preparing-the-dataset"> </a></h2><p>The dataset contains 'train' and 'valid' folders each of which contain a folder for each of the two classes: <strong>3</strong> and <strong>7</strong>. Create a list of tensors from the MNIST data. We have 6,131 <strong>3s</strong>, and 6,265 <strong>7s</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">)</span>
<span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">threes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">sevens</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">three_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">threes</span><span class="p">]</span>
<span class="n">seven_tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sevens</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(6131, 6265)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Combine all the images of each class into a single three-dimensional tensor and convert the pixel values to floats between 0 and 1. Looking at the shape of the tensor, we have 6,131 images of 3s that are 28 by 28 pixels.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked_sevens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">seven_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">three_tensors</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([6131, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Concatenate the separate class tensors into a single tensor <code>train_x</code> to hold all the images for training and create the tensor <code>train_y</code> to hold the training labels or targets (1 for <strong>3s</strong> and 0 for <strong>7s</strong>). The training images and labels are zipped together in <code>dset</code> because a PyTorch <code>Dataset</code> is required to return a tuple when indexed.
<strong><em>Note</em></strong>: the images have been changed from a 28 by 28 matrix to a 28*28 vector (784 column-long row) where each column represents a pixel value. This is important as it enables us to use matrix multiplication between the input data (pixel values) and parameters to produce an output.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">stacked_threes</span><span class="p">,</span> <span class="n">stacked_sevens</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">threes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sevens</span><span class="p">))</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">))</span>
<span class="n">dset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784]), torch.Size([1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the validation dataset in the same manner</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_3_tens</span> <span class="o">=</span> <span class="n">valid_3_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> 
                            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()])</span>
<span class="n">valid_7_tens</span> <span class="o">=</span> <span class="n">valid_7_tens</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">valid_3_tens</span><span class="p">,</span> <span class="n">valid_7_tens</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">valid_y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_3_tens</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_7_tens</span><span class="p">))</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">valid_dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span><span class="n">valid_y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now have two datasets: <code>dset</code> which contains all the training images and their associated labels, and <code>valid_dset</code> which contains all the validation images and their labels. The datasets are a list of tuple pairs where the first item is an image represented as a vector of magnitude 784 and the second item is a label, either 0 or 1.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-the-architecture">Building the architecture<a class="anchor-link" href="#Building-the-architecture"> </a></h2><p>The first step is to initialize the parameters. These are the weights or coefficients which will be applied to the data to make class predictions. It is common to initialize the parameters randomly. Create <code>weights</code>, a 784 row vector corresponding to the pixel length of the images, each row has a value randomly initialized using a normal random number distribution which will be applied to the pixel values to predict the class value. <code>bias</code> is a randomly initialised scalar variable which increases flexibility by allowing the output of the linear equations to be non-zero when the input values are 0.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">*</span><span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">((</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">bias</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784, 1]), torch.Size([1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The graph below shows that each of the 784 weights has been given a random value from a standard normal distribution.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">wdf</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span> <span class="p">:</span><span class="s1">&#39;weight value&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">wdf</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;weight value&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">wdf</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s2">&quot;Weights&quot;</span><span class="p">,</span> <span class="s2">&quot;Weight Value&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;seaborn.axisgrid.FacetGrid at 0x7ff25fe9f710&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-the-model">Define the model<a class="anchor-link" href="#Define-the-model"> </a></h3><p>Create a function that takes the image vectors as input and multiplies them by the parameters to produce an output which will be used to predict the class value. This simple function is actually the model and since the parameters are randomly intitialised its output won't actually have anything to do with what we want. However, once we compare the outputs with our targets and use some <em>loss function</em> to evaluate its performance, we can use SGD to minimise the loss and improve the model.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear1</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span> <span class="k">return</span> <span class="n">xb</span><span class="nd">@weights</span> <span class="o">+</span> <span class="n">bias</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">linear1</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
<span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-9.8383],
        [-5.7327],
        [-0.0574],
        ...,
        [-2.0469],
        [-3.5765],
        [ 3.2822]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we set an arbitrary threshold to predict whether a given image is a <strong>3</strong> or a <strong>7</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">corrects</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">&gt;</span><span class="n">thresh</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="o">==</span> <span class="n">train_y</span>
<span class="n">corrects</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.3266376256942749</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The graph below shows the distribution of the prediction values for each class value. We can see that our arbitrary threshold of 0 in fact does a very poor job of predicting the class values because there is a healthy mix of both <strong>3</strong>s and <strong>7</strong>s on either end of 0. These two lovely shaped distributions are to be expected from intialising the weights randomly using the standard normal distribution.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;threes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="mi">6131</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;sevens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6131</span><span class="p">:]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threes&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sevens&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightsalmon&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff25cdf2a58&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-a-loss-function">Define a <em>loss function</em><a class="anchor-link" href="#Define-a-loss-function"> </a></h3><p>The loss function is a means of assessing the the current weight assignments in terms of actual performance.</p>
<p>This loss function takes the outputs from the <code>linear1</code> model as inputs and compares them to the targets. It measures the distance of each prediction from its target label (i.e. 1 for <strong>3</strong>s and 0 for <strong>7</strong>s) for a given batch containing prediction values and target labels and returns an average of these distances. It is our goal to minimise this function by changing the values of the weights. A score of 0 would mean that for some combination of weights applied to a batch of inputs, the model produced outputs that corresponded exactly to the batch's target labels.</p>
<p>One problem with <code>mnist_loss</code> as currently defined is that it assumes that prediction values are always between 0 and 1 (the above graph shows they are actually ranging from around -20 to 20). The sigmoid method in the loss function transforms the prediction values into values that fall in the domain of 0 to 1 to allow our loss function to work.</p>
<p><img src="https://drive.google.com/uc?id=1XIjbvnIOU_qfp7tBzXB-w-UsPL8c5ccE" alt="picture" /></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mnist_loss</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
  <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">targets</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creater the <code>dl</code> <code>DataLoader</code> which takes our dataset and turns it into an iterator over many batches. The batchs are tuples of tensors representing batches of images and targets. Here we specify a batch size of 256. Processing the dataset in batches like this is the difference between <em>Gradient Descent</em> and <em>Stochastic Gradient Descent</em>. <em>Gradient Descent</em> requires much more computational resources as the entire dataset needs to be processed for one epoch.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">valid_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_dset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Optimisation">Optimisation<a class="anchor-link" href="#Optimisation"> </a></h3><p>Now that we have a loss function to measure the performance of our model, we need a method that updates the paramaters (weights and bias) to minimise the loss function and improve the model's performance, this is often referred to as stepping. The goal is to adjust the weights until we find the bottom of the loss function and an efficient method for this is to use the gradient of the loss function to tell us which direction to adjust the weights.</p>
<p><img src="https://drive.google.com/uc?id=1oQUTm8kOQXkOw1i1UzgynWRve1VKOoL_" alt="picture" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>calc_grad</code> will process our batches through our model and assess performance using the loss function while tracking the gradient for each weight.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_grad</span><span class="p">(</span><span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_batch</span><span class="p">)</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="n">mnist_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">)</span>
  <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now all that is left is to update the parameters based on the gradients. It is common to multiply the gradient by a small number called the learning rate to control the size of gradient steps. If it is too large, the algorithm could step beyond the minimum and jump around the function a lot. If it is too small, it will take longer to reach the minimum. Often times the learning rate is set through some trial and error.</p>
<p>The full process is represented in the flow chart below and shows how it is an iterative process.
We initialise the weights and measure the predictions from a model using a loss function, record the gradients and step the parameters toward the bottom of the loss function. We repeat the process with the stepped parameters and continue iterating to improve the predictions until we decide to stop the process.</p>
<p><img src="https://drive.google.com/uc?id=1raj8HqidkiAIO8pa73xt4lNK_vPeapXn" alt="picture" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>train_epoch</code> function includes a loop to upgrade the parameters based on the gradients and a learning rate: <code>lr</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span> <span class="ow">in</span> <span class="n">dl</span><span class="p">:</span>
    <span class="n">calc_grad</span><span class="p">(</span><span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
      <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">*</span><span class="n">lr</span>
      <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also want to check how we're doing, by looking at the accuracy of the validation set. To decide if an output represents a <strong>3</strong> or a <strong>7</strong>, we can just check whether it's greater than 0. The <code>batch_accuracy</code> function does this and returns an accuracy score. <code>validate_epoch</code> then puts all the batches together and returns an overall score for each epoch.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">batch_accuracy</span><span class="p">(</span><span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">x_batch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">preds</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">==</span> <span class="n">y_batch</span>
    <span class="k">return</span> <span class="n">correct</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">validate_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">accs</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">),</span> <span class="n">yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">valid_dl</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">accs</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now all thats left is to train the model. First we'll run three epochs and see how the accuracy improves and look at how the distribution of class values (targets) changes. The accuracy improves rapidly in just three epochs and we receive accuracy scores of 52.28%, 65.23% and 85%.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bias</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
  <span class="n">train_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.5228 0.6523 0.85 </pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The graph below shows the distributions of the predictions of the class values being pulled away from each other.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">linear1</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;threes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="mi">6131</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;sevens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6131</span><span class="p">:]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threes&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sevens&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightsalmon&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff26081e898&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After 15 more epochs the accuracy improves to over 97%</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
  <span class="n">train_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">linear1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.9242 0.9501 0.957 0.9609 0.9628 0.9648 0.9657 0.9682 0.9687 0.9691 0.9696 0.9701 0.9701 0.9701 0.9701 </pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also see the how the current combination of weights produces predictions which divide the class values into two distinct groups compared to the starting randomly initialised weights. The predictions of images of <strong>7</strong>s which intially had a greater mean than the predictions of <strong>3</strong>s has been pulled to the left into larger negative values. This is because large negative values are converted to 0 or very close to 0 by the sigmoid function. Since we set the target for <strong>7</strong>s to 0, the weights have been optimised to the point where the model will produce large negative prediction values for images of <strong>7</strong>s which corresponds to its target label of 0. Likewise the model will produce large positive prediction values for <strong>3</strong>s which corresponds to its target label of 1 once the sigmoid function is applied.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">linear1</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;threes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="mi">6131</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;sevens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6131</span><span class="p">:]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;threes&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sevens&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightsalmon&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff25d355668&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Distribution-of-predictions-using-randomly-initialised-weights">Distribution of predictions using randomly initialised weights<a class="anchor-link" href="#Distribution-of-predictions-using-randomly-initialised-weights"> </a></h3><p><img src="https://drive.google.com/uc?id=1eDzD7W5GqC55Ph5H-Gg5XTPyUvHR7fCg" alt="picture" /></p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/datascience/2020/11/14/_11_15_SGD.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/datascience/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/datascience/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/datascience/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A blog to track my data science learning and help others on their journey</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Toodoi" title="Toodoi"><svg class="svg-icon grey"><use xlink:href="/datascience/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
